# 划词翻译助手 - 修复版使用说明

## 问题修复说明

我们已经对划词翻译助手进行了修复和改进，主要解决了以下问题：

1. **增强错误处理机制**：
   - 改进了background.js中的消息发送错误处理
   - 连接失败时会清除GPT页面设置并通知用户
   - 完善了异步操作响应处理

2. **改进用户反馈**：
   - 在content.js中添加了页面内通知功能
   - 错误信息会直接显示在页面上，便于用户了解问题

3. **更新权限配置**：
   - 确保manifest.json包含所有必要的权限

4. **添加调试工具**：
   - 创建了增强版调试脚本（advanced_debug.js）
   - 简化版调试脚本（simple_debug.js）

## 安装和设置

1. 打开Chrome浏览器，进入扩展管理页面：
   - 在地址栏输入 `chrome://extensions/`
   - 或者通过菜单：更多工具 > 扩展程序

2. 开启开发者模式（页面右上角开关）

3. 点击"加载已解压的扩展程序"，选择包含插件文件的文件夹

4. 确保插件已启用

## 使用方法

### 设置GPT目标页面

1. 打开GPT网站页面（如 chatgpt.com）
2. 点击浏览器工具栏中的划词翻译助手图标
3. 插件会提示"已将此页面设置为GPT目标页面"
4. 插件图标会变为激活状态（绿色）

### 使用划词翻译功能

#### 方法一：划词点击翻译按钮
1. 在任何网页上选择需要翻译的文本
2. 点击出现的"🌐翻译"按钮
3. 文本将自动发送到GPT页面进行翻译

#### 方法二：右键菜单翻译
1. 在任何网页上选择需要翻译的文本
2. 右键点击选中文本
3. 在右键菜单中选择"使用划词翻译助手翻译"
4. 文本将自动发送到GPT页面进行翻译

## 调试和测试

### 使用调试页面

1. 在浏览器中打开 `debug.html` 文件
2. 使用页面上的按钮进行各种测试：
   - 检查GPT页面设置
   - 设置/清除GPT页面
   - 发送测试文本

### 使用测试页面

1. 在浏览器中打开 `test.html` 文件
2. 按照页面上的5步测试流程进行测试

## 常见问题排查

### 1. GPT页面连接问题
如果遇到GPT页面连接问题，请尝试以下步骤：
1. 重新加载插件
2. 重新打开GPT页面并设置为目标页面
3. 检查浏览器控制台是否有错误信息
4. 注意某些网站的安全限制可能影响插件功能

### 2. 文本无法发送到GPT页面
如果文本无法发送到GPT页面，请检查：
1. 是否已正确设置GPT目标页面
2. GPT页面是否仍然打开
3. 插件图标是否为激活状态（绿色）

### 3. 插件功能异常
如果插件功能异常，请尝试：
1. 重新加载插件
2. 清除浏览器缓存
3. 检查是否有浏览器扩展冲突

## 文件结构说明

- `manifest.json` - 插件配置文件
- `background_fixed.js` - 修复版后台脚本
- `content_fixed.js` - 修复版内容脚本
- `popup.html` - 插件弹出页面
- `debug.html` - 调试页面
- `test.html` - 测试页面
- `advanced_debug.js` - 增强版调试脚本
- `simple_debug.js` - 简化版调试脚本
- `icon.png` - 插件图标
- `icon_active.png` - 插件激活状态图标

## 注意事项

1. 请确保GPT页面保持打开状态，否则插件无法发送文本
2. 某些网站的安全策略可能阻止插件正常工作
3. 如果遇到问题，请查看浏览器控制台的错误信息
4. 插件需要必要的权限才能正常工作，请确保已授权